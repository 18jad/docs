---
title: 'Prisma Client extensions'
metaTitle: 'Prisma Client extensions (Preview)'
metaDescription: 'Extend the functionality of Prisma Client'
preview: true
tocDepth: 3
---

<TopBlock>

<Admonition type="info">

This page is in draft for Prisma version 4.6.0. We plan to publish this page for version 4.7.0.

</Admonition>

You can use Prisma Client extensions to add functionality to the models, results objects, queries, or Prisma Client itself, in the following ways.

</TopBlock>

## About Prisma Client extensions

To create Prisma Client extensions, use the `$extends` [client-level method](/reference/api-reference/prisma-client-reference#client-methods).

- You can create [multiple independent extensions](#multiple-extensions), each in is own isolated instance of Prisma Client.
- You can also [share your Prisma Client extensions](#share-extensions) with other Prisma users, and [import Prisma Client extensions developed by other users](#install-a-packaged-extension) into your Prisma project.

## Prerequisites

To use Prisma Client extensions, you must enable the `clientExtensions` feature flag in the generator block of your `schema.prisma` file, as follows:

```prisma
generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["clientExtensions"]
}
```

## Extend Prisma Client

There are four types of extension. To learn how to use these, visit the pages below:

- `model` extensions: [add custom methods or fields to your models](/concepts/components/prisma-client/client-extensions/client-extensions-model)
- `result` extensions: [add custom results objects to Prisma Client](/concepts/components/prisma-client/client-extensions/client-extensions-result)
- `query` extensions: [create custom Prisma Client queries](/concepts/components/prisma-client/client-extensions/client-extensions-query)
- `client` extensions: [add client-level methods to Prisma Client](/concepts/components/prisma-client/client-extensions/client-extensions-client)

## Multiple extensions

Each extended client that you create operates independently, in an isolated instance, and cannot conflict with other extended clients. Therefore, you can use extensions to create multiple variations of Prisma Client for different purposes, and use them simultaneously. For example, you might have a `result` extension for one purpose and a `model` extension for another.

Each extended client is a virtual forked state of the standard Prisma Client. This process does not change the state of the original client.

In the following example, each call to `$extends` creates a completely separate extended client:

```ts
const xprisma = prisma
.$extends({ ... }) // returns an extended client from the standard client
.$extends({ ... }) // returns an extended client from the standard client
.$extends({ ... }) // returns an extended client from the standard client
```

## Share Prisma Client extensions

You can share Prisma Client extensions with other users, either as packages or as code snippets. To create an extension that is more likely to work for other users, use the `$all` prefix, for example `$allModels`. This lets you build an extension that applies generally, and not just to your specific schema.

For example, a generic extension might take the following form:

```ts
const xprisma = new prisma.$extends({
  model: {
    $allModels: {
      getClass<T extends object>(this: T): new () => T {
        return class {
          /** Generic Implementation */
        } as any
      },
    },
  },
})

class UserService extends xprisma.user.getClass() {
  method() {
    const user = this.findFirst({}) // fully type-safe
  }
}
```

### Package an extension

To package an extension, use `Prisma.createExtension`. This is very similar to `prisma.$extends`, but it declares an extension.

For example:

```ts

import { Prisma } from '@prisma/client'

export default Prisma.createExtension({
  model: {
    $allModels: {
      // new method
      findOrCreate(...) { }
    }
  }
})
```

**_TBD: what happens next? how does the user share it?_**

### Install a packaged extension

In your project, you can install any Prisma Client extension that another user has published to `npm`. To do so, add the following line to your application code:

**\*TBD: how does the user determine what extensions are available so they can install on?**

```ts
npm install prisma-extension-<name>
```

For example, if an available extension is called `find-or-create`, you could install it as follows:

```ts
npm install prisma-extension-find-or-create
```

Import the extension and load it into your client instance as follows:

```ts
import findOrCreate from 'prisma-extension-find-or-create'

const xprisma = prisma.$extends(findOrCreate)
const user = await xprisma.user.findOrCreate({ ... })

xprisma.user.findOrCreate()
```
