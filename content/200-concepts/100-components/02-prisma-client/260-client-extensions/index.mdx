---
title: 'Prisma Client extensions'
metaTitle: 'Prisma Client extensions (Preview)'
metaDescription: 'Extend the functionality of Prisma Client'
preview: true
tocDepth: 3
---

<TopBlock>

<Admonition type="info">

This page is in draft for Prisma version 4.6.0. We plan to publish this page for version 4.7.0.

</Admonition>

You can use Prisma Client extensions to add functionality to Prisma Client in the following ways:

- Add custom methods or fields to your models
- Add custom results objects to Prisma Client
- Create custom Prisma Client queries
- Add client-level methods to Prisma Client

To create Prisma Client extensions, use the `$extends` client-level method. `$extends` returns a forked state of Prisma Client. This means that you can create [multiple extensions](#multiple-extensions), each in is own isolated instance of Prisma Client.

You can also [share your Prisma Client extensions](#share-extensions) with other Prisma users, and [import Prisma Client extensions developed by other users](#install-a-packaged-extension) into your Prisma project.

</TopBlock>

## Docs notes (this section to be removed)

Still to do:

- Any workarounds that overlap with examples in this section - link from there to here - e.g. middlewares - ** check for candidates, and add to issue ticket **
- Explain how type utilities can be used in $extends for full type-safety - need info on this

## Prerequisites

To use Prisma Client extensions, you must enable the `clientExtensions` feature flag in the generator block of your `schema.prisma` file, as follows:

```prisma
generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["clientExtensions"]
}
```

**Are there any dependencies you need to install?**

## How to extend Prisma Client

To learn how to extend Prisma Client, and to see examples, visit the appropriate page below:

- [Add custom methods or fields to your models](/concepts/components/prisma-client/client-extensions/client-extensions-model)
- [Add custom results objects to Prisma Client](/concepts/components/prisma-client/client-extensions/client-extensions-results)
- [Create custom Prisma Client queries](/concepts/components/prisma-client/client-extensions/client-extensions-query)
- [Add client-level methods to Prisma Client](/concepts/components/prisma-client/client-extensions/client-extensions-client)

## Multiple extensions

Each extension that you create operates independently and cannot conflict with other extensions. Therefore, you can use extensions to create multiple variations of Prisma Client for different purposes, and use them simultaneously. For example, you might have a `result` extension for one purpose and a `model` extension for another.

When you use `$extends`, you get a virtual forked state of Prisma Client. This adds a new layer of extensions on top of the previous client, each one based on the state of the original client. This process does not change the state of the original client. Each extension operates in an isolated instance of Prisma Client.

In the following example, each call to `$extends` creates a completely separate client:

```ts
const xprisma = prisma
.$extends({ ... }) // returns an extended client from the original client
.$extends({ ... }) // returns an extended client from the extended client
.$extends({ ... }) // returns an extended client from the extended client
```

## Share Prisma Client extensions

You can share Prisma Client extensions with other users, either as packages or as code snippets. To create an extension that works for other users, you can use the `$all` prefix, as in `$allModels`. This lets you build an extension that applies generally, and not just to your specific application.

For example, a generic extension might take the following form:

```ts
const xprisma = new prisma.$extends({
  model: {
    $allModels: {
      getClass<T extends object>(this: T): new () => T {
        return class {
          /** Generic Implementation */
        } as any
      },
    },
  },
})

class UserService extends xprisma.user.getClass() {
  method() {
    const user = this.findFirst({}) // fully type-safe
  }
}
```

### Package an extension

To package an extension, use `Prisma.createExtension`. This is a mirror of `prisma.$extends`, but lets you declare an extension.

For example:

```ts

import { Prisma } from '@prisma/client'

export default Prisma.createExtension({
  model: {
    $allModels: {
      // new method
      findOrCreate(...) { }
    }
  }
})
```

### Install a packaged extension

** How do you discover the packaged extensions - how do you know what's available? **

In your project, you can install any Prisma Client extension that another user user has published to `npm`. To do so, add the following line to your application code:

```ts
npm install prisma-extension-<name>
```

For example:

```ts
npm install prisma-extension-find-or-create
```

Import the extension and load it into your client instance as follows:

```ts
import findOrCreate from 'prisma-extension-find-or-create'

const xprisma = prisma.$extends(findOrCreate)
const user = await xprisma.user.findOrCreate({ ... })

xprisma.user.findOrCreate()
```
